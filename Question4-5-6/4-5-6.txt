I am unsure how to correctly implement expolits for questions 4, 5 and 6. However, from my research, I believe the script provided is vulnerable to a CRLF injection attack that would allow an attacker add additional headers to HTTP queries or requests to other site embeded in URL, such as sending mails on open mail servers. The difference between exploiting this on a Unix host, Windows host or Mac host is that each uses different encoding for Carriage Return. Unix uses LF (%0a). Windows uses CRLF (%0d%0a). Mac uses CR (%0d). Mitigation is often built into framework automatically these days but can also be mitigated by including validation of requests and stripping out instances of %0d , %0a and %0d%0a 

Speacifically for 6, perhaps one could include all possible combinations for CR, LF and CRLF as 3 requests embeded in the URL?